"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1524],{5873:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/burndown_chart-979b2972c8ed766365cb0f08a98e2514.png"},7240:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"development/sprints/sprint_1","title":"May 14 - May 27, 2025","description":"_May 14 - May 27, 2025_","source":"@site/docs/development/sprints/sprint_1.md","sourceDirName":"development/sprints","slug":"/development/sprints/sprint_1","permalink":"/tutorlm/docs/development/sprints/sprint_1","draft":false,"unlisted":false,"editUrl":"https://github.com/ohjime/tutorlm/tree/main/docs/docs/development/sprints/sprint_1.md","tags":[],"version":"current","lastUpdatedAt":1750309997000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"May 14 - May 27, 2025"},"sidebar":"developmentSidebar","previous":{"title":"Sprint Reports","permalink":"/tutorlm/docs/development/sprints/"}}');var i=t(4848),s=t(8453);const l={sidebar_position:4,title:"May 14 - May 27, 2025"},a="Sprint Summary",d={},o=[{value:"Overview",id:"overview",level:2},{value:"Completed Tasks",id:"completed-tasks",level:2},{value:"User Stories Achieved",id:"user-stories-achieved",level:2},{value:"Burn Down Chart",id:"burn-down-chart",level:2},{value:"Issues Resolved",id:"issues-resolved",level:2},{value:"Critical Bug Report",id:"critical-bug-report",level:2},{value:"Tutor Availability Frozen on First Tutor in SessionCreate Workflow",id:"tutor-availability-frozen-on-first-tutor-in-sessioncreate-workflow",level:3},{value:"Context and Overview",id:"context-and-overview",level:4},{value:"Detailed Investigation and Root Cause",id:"detailed-investigation-and-root-cause",level:4},{value:"Steps to Reproduce",id:"steps-to-reproduce",level:4},{value:"Expected Behavior",id:"expected-behavior",level:4},{value:"Actual Behavior",id:"actual-behavior",level:4},{value:"Resolution",id:"resolution",level:4},{value:"Preventive Actions and Recommendations",id:"preventive-actions-and-recommendations",level:4},{value:"Lessons Learned",id:"lessons-learned",level:4},{value:"<code>TimeInterval.fromJson</code> Throws Unexpected <code>_TypeError</code> Instead of <code>ArgumentError</code>",id:"timeintervalfromjson-throws-unexpected-_typeerror-instead-of-argumenterror",level:3},{value:"Overview",id:"overview-1",level:4},{value:"Environment",id:"environment",level:4},{value:"Problem Description",id:"problem-description",level:4},{value:"Steps to Reproduce",id:"steps-to-reproduce-1",level:4},{value:"Write a test expecting an ArgumentError when required keys are missing:",id:"write-a-test-expecting-an-argumenterror-when-required-keys-are-missing",level:5},{value:"Run the test:",id:"run-the-test",level:5},{value:"Observe the failure:",id:"observe-the-failure",level:5},{value:"Expected Behavior",id:"expected-behavior-1",level:5},{value:"Root Cause",id:"root-cause",level:4},{value:"Solution",id:"solution",level:4},{value:"Test Results",id:"test-results",level:4},{value:"Conclusion",id:"conclusion",level:4},{value:"Signup Form Submission Fails Due to Missing <code>save()</code> Call",id:"signup-form-submission-fails-due-to-missing-save-call",level:3},{value:"Overview",id:"overview-2",level:4},{value:"Environment",id:"environment-1",level:4},{value:"Problem Description",id:"problem-description-1",level:4},{value:"Steps to Reproduce",id:"steps-to-reproduce-2",level:4},{value:"Fill the Signup Form Step:",id:"fill-the-signup-form-step",level:5},{value:"Press &quot;NEXT&quot;:",id:"press-next",level:5},{value:"Observe Printed Output:",id:"observe-printed-output",level:5},{value:"Actual Behavior",id:"actual-behavior-1",level:5},{value:"Root Cause",id:"root-cause-1",level:4},{value:"Solution",id:"solution-1",level:4},{value:"Before:",id:"before",level:5},{value:"After (Fixed):",id:"after-fixed",level:5},{value:"Test Results",id:"test-results-1",level:4},{value:"Conclusion",id:"conclusion-1",level:4}];function c(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"sprint-summary",children:"Sprint Summary"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"May 14 - May 27, 2025"})})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"During this sprint, significant progress was made across multiple tasks, user stories, and epics, enhancing the application's functionality, user experience, and maintainability. As the sole developer, efforts were concentrated effectively to address key priorities efficiently."}),"\n",(0,i.jsx)(n.h2,{id:"completed-tasks",children:"Completed Tasks"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Addressed critical bug fixes and improved overall application stability."}),"\n",(0,i.jsx)(n.li,{children:"Enhanced database query efficiency, significantly reducing load times."}),"\n",(0,i.jsx)(n.li,{children:"Improved UI responsiveness, offering users smoother interactions."}),"\n",(0,i.jsx)(n.li,{children:"Updated documentation and code comments for clarity and easier future maintenance."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"user-stories-achieved",children:"User Stories Achieved"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Implemented comprehensive user authentication, ensuring secure access."}),"\n",(0,i.jsx)(n.li,{children:"Developed intuitive session scheduling, editing, and tracking functionalities."}),"\n",(0,i.jsx)(n.li,{children:"Integrated seamless session recording and playback features to enhance user engagement."}),"\n",(0,i.jsx)(n.li,{children:"Introduced detailed user profile customization and management options."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"burn-down-chart",children:"Burn Down Chart"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Burn Down Chart",src:t(5873).A+"",width:"1796",height:"458"})}),"\n",(0,i.jsx)(n.h2,{id:"issues-resolved",children:"Issues Resolved"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Fixed critical bugs causing crashes during session scheduling."}),"\n",(0,i.jsx)(n.li,{children:"Corrected UI anomalies observed on profile customization screens."}),"\n",(0,i.jsx)(n.li,{children:"Resolved synchronization errors due to API endpoint mismatches."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"critical-bug-report",children:"Critical Bug Report"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"tutor-availability-frozen-on-first-tutor-in-sessioncreate-workflow",children:"Tutor Availability Frozen on First Tutor in SessionCreate Workflow"}),"\n",(0,i.jsx)(n.h4,{id:"context-and-overview",children:"Context and Overview"}),"\n",(0,i.jsx)(n.p,{children:"A significant issue emerged during the development of the session creation feature. While loading tutor availabilities, a discrepancy in schedule retrieval occurred due to inconsistencies in date-time formatting. The root cause was identified as an additional zero in the ISO date format, introduced unintentionally by an automated Firebase generation script. This subtle formatting difference caused schedule data retrieval failures for most users, except one correctly formatted test user, which masked the severity of the issue. The excessive dependency on automation without adequate validation significantly delayed issue identification and resolution. After correcting the generation script and regenerating user data, the issue was fully resolved."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Names"}),"\n",(0,i.jsx)(n.li,{children:"Subjects"}),"\n",(0,i.jsx)(n.li,{children:"Avatars"}),"\n",(0,i.jsx)(n.li,{children:"Cover photos"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"At first glance, all tutor data seemed synchronized perfectly, with matched emails, usernames, and subjects confirming correct repository interactions."}),"\n",(0,i.jsx)(n.p,{children:"However, an issue became apparent when attempting to switch tutors within the UI. Although the displayed header changed to reflect the newly selected tutor\u2019s name, the calendar beneath persisted in displaying the availability of only the initial tutor, Osman Jime. Investigation of the backend through Firestore confirmed the second tutor's schedule data existed, indicating that the problem was rooted in the Flutter frontend layer rather than the backend."}),"\n",(0,i.jsx)(n.h4,{id:"detailed-investigation-and-root-cause",children:"Detailed Investigation and Root Cause"}),"\n",(0,i.jsxs)(n.p,{children:["The core issue was traced to the JSON deserialization process responsible for transforming Firestore documents into domain model objects. Specifically, the deserialization logic within ",(0,i.jsx)(n.code,{children:"User.fromJson"})," silently swallowed exceptions encountered when parsing schedule data:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"// user.dart (abridged)\nfactory User.fromJson(Map<String, dynamic> map) {\n  Schedule? schedule;\n  try {\n    final schedData = map['schedule'];\n    if (schedData is Map<String, dynamic>) {\n      schedule = Schedule.fromJson(schedData); // Potentially throws exception\n    }\n  } catch (_) {\n    schedule = null; // Exception silently swallowed\n  }\n  return User(\n    email: map['email'] ?? '',\n    name:  map['name']  ?? '',\n    schedule: schedule,\n  );\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This ",(0,i.jsx)(n.code,{children:"User.fromJson"})," method delegates the parsing responsibility to ",(0,i.jsx)(n.code,{children:"Schedule.fromJson"}),", and subsequently ",(0,i.jsx)(n.code,{children:"TimeSlot.fromJson"}),", which specifically uses ",(0,i.jsx)(n.code,{children:"DateTime.parse"})," to process timestamp strings:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"// timeslot.dart (abridged)\nfinal startDt = DateTime.parse(startRaw);   // Throws exception on malformed ISO\nfinal endDt   = DateTime.parse(endRaw);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["An inconsistency emerged because manually seeded tutors had correctly formatted timestamps (e.g., ",(0,i.jsx)(n.code,{children:"2025-05-28T13:00:00.000"}),"), whereas tutors created via the Python bulk seeding script included an erroneous additional colon (e.g., ",(0,i.jsx)(n.code,{children:"2025-05-28T13:00:00:00"}),"). This subtle format discrepancy triggered a ",(0,i.jsx)(n.code,{children:"FormatException"}),", causing the deserialization process to fail silently, resulting in ",(0,i.jsx)(n.code,{children:"User"})," objects with null schedules. Due to the Bloc logic in the SessionCreate workflow retaining the last non-null schedule, the initial tutor's calendar remained stuck on the screen for all subsequent tutors."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"hi",src:t(9057).A+"",width:"1328",height:"1076"})}),"\n",(0,i.jsx)(n.h4,{id:"steps-to-reproduce",children:"Steps to Reproduce"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Seed the database using the original Python script, which generates timestamp strings with extra colons."}),"\n",(0,i.jsx)(n.li,{children:"Launch the application and initiate the Create Session workflow."}),"\n",(0,i.jsx)(n.li,{children:"Observe the calendar displayed correctly for the first tutor."}),"\n",(0,i.jsx)(n.li,{children:"Select any subsequent tutor; notice the header updates, but the calendar remains unchanged."}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"expected-behavior",children:"Expected Behavior"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"When selecting a different tutor, the displayed availability panel should update accordingly to reflect the newly selected tutor\u2019s schedule."}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"actual-behavior",children:"Actual Behavior"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The availability panel incorrectly remains fixed, continuously showing the schedule of the first successfully parsed tutor."}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"resolution",children:"Resolution"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Data Correction:"})," Updated the Python seeding script to produce valid ISO-8601 formatted timestamps, specifically using milliseconds precision (",(0,i.jsx)(n.code,{children:".000"}),"). All previously seeded data was purged and regenerated."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Verification:"})," After reseeding the data, each tutor\u2019s availability correctly updates upon selection, and the carousel behavior is now as intended."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"preventive-actions-and-recommendations",children:"Preventive Actions and Recommendations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Error Handling Improvement:"})," Modify ",(0,i.jsx)(n.code,{children:"User.fromJson"})," to re-throw, log, or explicitly handle parsing exceptions, preventing silent failures."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Enhanced Testing:"})," Implement a unit test that validates the integrity of the JSON round-trip process for ",(0,i.jsx)(n.code,{children:"TimeSlot"})," objects, ensuring format correctness."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CI Integration:"})," Establish a Continuous Integration check to validate outputs from automated data seeding scripts."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Data Storage Recommendation:"})," Store timestamps as native Firestore ",(0,i.jsx)(n.code,{children:"Timestamp"})," objects instead of formatted strings, significantly reducing potential format-related errors."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"lessons-learned",children:"Lessons Learned"}),"\n",(0,i.jsx)(n.p,{children:"Relying heavily on automated data generation scripts accelerates development but can amplify minor formatting errors. Explicit validation tests, even simple round-trip assertions, provide substantial value by catching such subtle discrepancies early, saving significant debugging effort."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.h3,{id:"timeintervalfromjson-throws-unexpected-_typeerror-instead-of-argumenterror",children:[(0,i.jsx)(n.code,{children:"TimeInterval.fromJson"})," Throws Unexpected ",(0,i.jsx)(n.code,{children:"_TypeError"})," Instead of ",(0,i.jsx)(n.code,{children:"ArgumentError"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"overview-1",children:"Overview"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Component:"})," ",(0,i.jsx)(n.code,{children:"TimeInterval.fromJson"})," constructor in ",(0,i.jsx)(n.code,{children:"lib/core/models/availability.dart"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Symptoms:"})," Tests expecting an ",(0,i.jsx)(n.code,{children:"ArgumentError"})," on invalid JSON inputs instead fail with a Dart ",(0,i.jsx)(n.code,{children:"_TypeError"})," (",(0,i.jsx)(n.code,{children:"Null is not a subtype of type 'int' in type cast"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Impact:"})," Invalid JSON inputs are not being handled gracefully; instead of a clear ",(0,i.jsx)(n.code,{children:"ArgumentError"}),", callers see a confusing type-cast error."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," Fixed by converting the generative constructor into a validating factory constructor."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"environment",children:"Environment"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Flutter SDK"}),(0,i.jsx)(n.td,{children:"3.13.0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Dart SDK"}),(0,i.jsx)(n.td,{children:"2.19.0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"OS"}),(0,i.jsx)(n.td,{children:"macOS 14.3 (Darwin 23.4.0)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Project"}),(0,i.jsx)(n.td,{children:"Tutorly (cmpt395/new/tutorly)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"File under test"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"lib/core/models/availability.dart"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Test file"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"test/core/models/time_interval_test.dart"})})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"problem-description",children:"Problem Description"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"TimeInterval"})," model is meant to parse JSON maps of the form:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"{\n  'start': <int>,\n  'end':   <int>,\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"When keys are missing or values are not integers, the code should throw an ArgumentError. However, the existing constructor uses a generative initializer list:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"TimeInterval.fromJson(Map<String, dynamic> json)\n  : start = json['start'] as int,\n    end   = json['end']   as int {\n  if (!json.containsKey('start') || !json.containsKey('end')) {\n    throw ArgumentError(\n      'Invalid JSON: Missing required keys \"start\" or \"end\".',\n    );\n  }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Because Dart executes the initializer list before the constructor body, a missing key leads to json['end'] being null, and null as int causes a _TypeError instead of the intended ArgumentError."}),"\n",(0,i.jsx)(n.h4,{id:"steps-to-reproduce-1",children:"Steps to Reproduce"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h5,{id:"write-a-test-expecting-an-argumenterror-when-required-keys-are-missing",children:"Write a test expecting an ArgumentError when required keys are missing:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"test('fromJson should throw ArgumentError on missing keys', () {\n  expect(\n    () => TimeInterval.fromJson({'start': 10}),\n    throwsArgumentError\n  );\n});\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h5,{id:"run-the-test",children:"Run the test:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-terminal",children:"flutter test test/core/models/time_interval_test.dart\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h5,{id:"observe-the-failure",children:"Observe the failure:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-terminal",children:"Expected: throws <Instance of 'ArgumentError'>\nActual:   <Closure: ...> threw _TypeError: type 'Null' is not a subtype of type 'int'\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h5,{id:"expected-behavior-1",children:"Expected Behavior"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u2022\tWhen either start or end is missing:\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u2022\tThe constructor should throw an ArgumentError with a clear message.\n\u2022\tWhen either value is present but not an integer:\n\u2022\tThe constructor should throw an ArgumentError indicating the type mismatch.\n"})}),"\n",(0,i.jsx)(n.p,{children:"5. ##### Actual Behavior\n\u2022\tMissing or non-int values result in a Dart _TypeError from the cast in the initializer list.\n\u2022\tThe custom error-checking code in the constructor body never runs."}),"\n",(0,i.jsx)(n.h4,{id:"root-cause",children:"Root Cause"}),"\n",(0,i.jsx)(n.p,{children:"Dart\u2019s initializer list runs before the constructor body. The code:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"start = json['start'] as int,\nend   = json['end']   as int\n"})}),"\n",(0,i.jsx)(n.p,{children:"performs the cast immediately. If json['end'] is null (key missing) or not an int, Dart throws a _TypeError before reaching the if (!json.containsKey(...)) check."}),"\n",(0,i.jsx)(n.h4,{id:"solution",children:"Solution"}),"\n",(0,i.jsx)(n.p,{children:"Convert fromJson into a factory constructor that:\n1.\tInspects the Map for required keys.\n2.\tValidates their types.\n3.\tOnly then calls the generative TimeInterval constructor."}),"\n",(0,i.jsx)(n.p,{children:"Updated Code in availability.dart"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"class TimeInterval extends Equatable {\n  final int start;\n  final int end;\n\n  const TimeInterval({required this.start, required this.end})\n    : assert(start >= 0 && start <= 23, 'Start must be between 0 and 23'),\n      assert(end   >= 0 && end   <= 23, 'End   must be between 0 and 23');\n\n  bool get isValid => start < end;\n\n  String toJson() {\n    return '{start: $start, end: $end}';\n  }\n\n-  TimeInterval.fromJson(Map<String, dynamic> json)\n-    : start = json['start'] as int,\n-      end   = json['end']   as int {\n-    if (!json.containsKey('start') || !json.containsKey('end')) {\n-      throw ArgumentError(\n-        'Invalid JSON: Missing required keys \"start\" or \"end\".',\n-      );\n-    }\n-  }\n+  factory TimeInterval.fromJson(Map<String, dynamic> json) {\n+    // Check presence of required keys\n+    if (!json.containsKey('start') || !json.containsKey('end')) {\n+      throw ArgumentError(\n+        'Invalid JSON: Missing required keys \"start\" or \"end\".'\n+      );\n+    }\n+\n+    final startValue = json['start'];\n+    final endValue   = json['end'];\n+\n+    // Validate types\n+    if (startValue is! int || endValue is! int) {\n+      throw ArgumentError(\n+        'Invalid JSON: \"start\" and \"end\" must be integers.'\n+      );\n+    }\n+\n+    return TimeInterval(\n+      start: startValue,\n+      end:   endValue,\n+    );\n+  }\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"test-results",children:"Test Results"}),"\n",(0,i.jsx)(n.p,{children:"After applying the factory constructor, we re ran the tests to get the following results:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-terminal",children:"    \u2705 Pass (throws ArgumentError)\n"})}),"\n",(0,i.jsx)(n.h4,{id:"conclusion",children:"Conclusion"}),"\n",(0,i.jsx)(n.p,{children:"By switching to a factory constructor, we regain full control over JSON validation before any type casting occurs. This ensures:\n\u2022\tClear, intentional ArgumentErrors on bad input.\n\u2022\tElimination of unexpected _TypeErrors from Dart\u2019s runtime.\n\u2022\tMore robust deserialization behavior aligned with the model\u2019s requirements."}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.h3,{id:"signup-form-submission-fails-due-to-missing-save-call",children:["Signup Form Submission Fails Due to Missing ",(0,i.jsx)(n.code,{children:"save()"})," Call"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"overview-2",children:"Overview"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Component:"})," Multi-step Signup Form (SignupPage Widget)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Symptoms:"})," Form submissions on intermediate steps result in empty form data being sent to SignupCubit."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Impact:"})," Signup data not updated correctly, causing incomplete or incorrect user profiles."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," Fixed by adding ",(0,i.jsx)(n.code,{children:".save()"})," or using ",(0,i.jsx)(n.code,{children:".saveAndValidate()"})," before form submission."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"environment-1",children:"Environment"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Flutter SDK"}),(0,i.jsx)(n.td,{children:"3.13.0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Dart SDK"}),(0,i.jsx)(n.td,{children:"2.19.0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"OS"}),(0,i.jsx)(n.td,{children:"macOS 14.3 (Darwin 23.4.0)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Project"}),(0,i.jsx)(n.td,{children:"Tutorly (cmpt395/new/tutorly)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"File under test"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"lib/signup/view/signup_page.dart"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Test file"}),(0,i.jsx)(n.td,{children:"Not yet created"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"problem-description-1",children:"Problem Description"}),"\n",(0,i.jsxs)(n.p,{children:["The SignupPage widget utilizes ",(0,i.jsx)(n.code,{children:"flutter_form_builder"})," with multiple steps. Each form step has its own form key managed through a list:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"formKeys = steps.map((e) => GlobalKey<FormBuilderState>()).toList();\n"})}),"\n",(0,i.jsxs)(n.p,{children:['When the user completes a step and presses the "NEXT" or "SUBMIT" button, the current implementation calls only ',(0,i.jsx)(n.code,{children:".validate()"})," on the form:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"final formKey = formKeys[currentStep];\nif (formKey.currentState!.validate()) {\n  print(formKey.currentState!.value);\n  context.read<SignupCubit>().updateUser(\n    formKey.currentState!.value,\n  );\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["However, calling ",(0,i.jsx)(n.code,{children:".validate()"})," alone does not save the field data into the form state. Consequently, ",(0,i.jsx)(n.code,{children:"formKey.currentState!.value"})," returns an empty map (",(0,i.jsx)(n.code,{children:"{}"}),")."]}),"\n",(0,i.jsx)(n.h4,{id:"steps-to-reproduce-2",children:"Steps to Reproduce"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h5,{id:"fill-the-signup-form-step",children:"Fill the Signup Form Step:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Enter valid data into text fields.\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h5,{id:"press-next",children:'Press "NEXT":'}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Tap the "NEXT" button at the bottom of the Signup form.\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h5,{id:"observe-printed-output",children:"Observe Printed Output:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Monitor console output for printed form data:\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"```terminal\n{}\n```\n"})}),"\n",(0,i.jsxs)(n.p,{children:["4. ##### Expected Behavior\n\u2022 Form data should be available and printed to the console.\n\u2022 The cubit's ",(0,i.jsx)(n.code,{children:"updateUser"})," method should receive populated data."]}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h5,{id:"actual-behavior-1",children:"Actual Behavior"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u2022 Empty data (`{}`) is sent to SignupCubit.\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u2022 User profiles remain incomplete.\n"})}),"\n",(0,i.jsx)(n.h4,{id:"root-cause-1",children:"Root Cause"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"flutter_form_builder"})," requires explicitly calling ",(0,i.jsx)(n.code,{children:".save()"})," or ",(0,i.jsx)(n.code,{children:".saveAndValidate()"})," before accessing form field data. Calling ",(0,i.jsx)(n.code,{children:".validate()"})," alone is insufficient, as it does not commit field data into the form state."]}),"\n",(0,i.jsx)(n.h4,{id:"solution-1",children:"Solution"}),"\n",(0,i.jsxs)(n.p,{children:["Replace the form validation logic in the button\u2019s ",(0,i.jsx)(n.code,{children:"onPressed"})," handler:"]}),"\n",(0,i.jsx)(n.h5,{id:"before",children:"Before:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"if (formKey.currentState!.validate()) {\n  // missing .save() call\n}\n"})}),"\n",(0,i.jsx)(n.h5,{id:"after-fixed",children:"After (Fixed):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"if (formKey.currentState!.saveAndValidate()) {\n  final data = formKey.currentState!.value; // Now populated correctly\n  context.read<SignupCubit>().updateUser(data);\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Alternatively:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"if (formKey.currentState!.validate()) {\n  formKey.currentState!.save();  // Explicit save call added\n  final data = formKey.currentState!.value;\n  context.read<SignupCubit>().updateUser(data);\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"test-results-1",children:"Test Results"}),"\n",(0,i.jsx)(n.p,{children:"After applying the fix and re-running the scenario, the form data is correctly populated:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-terminal",children:"{firstName: 'John', lastName: 'Doe'}\n"})}),"\n",(0,i.jsx)(n.p,{children:"SignupCubit now correctly updates the user data."}),"\n",(0,i.jsx)(n.h4,{id:"conclusion-1",children:"Conclusion"}),"\n",(0,i.jsxs)(n.p,{children:["Explicitly calling ",(0,i.jsx)(n.code,{children:".save()"})," or ",(0,i.jsx)(n.code,{children:".saveAndValidate()"})," ensures the form state accurately reflects the user's input. This fix results in successful data submissions and correct profile updates."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},9057:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/bug_1-916a082553f072c28268e9b82b3f2a74.png"}}]);